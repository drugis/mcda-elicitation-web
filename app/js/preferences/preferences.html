<div class="grid-x">
  <div class="cell">
    <span>Scenario:</span>
    <select id="scenario-selector" class="scenario-select" ng-model="scenario"
      ng-options="scenario.title for scenario in scenarios track by scenario.id"
      ng-change="scenarioChanged(scenario)"></select>
    <inline-help help-key="scenario"></inline-help>
    <a id="edit-scenario-button" ng-if="editMode.isUserOwner" ng-click="editScenarioTitle()" tooltip="Edit current scenario title"><i
        class="fa fa-edit"></i></a>
    <a id="create-scenario-button" ng-if="editMode.isUserOwner" ng-click="newScenario()" tooltip="Create clean scenario"><i
        class="fa fa-plus"></i></a>
    <a id="copy-scenario-button" ng-if="editMode.isUserOwner" ng-click="copyScenario()" tooltip="Copy current scenario"><i
        class="fa fa-copy"></i></a>
  </div>
</div>
<br>
<div id="partial-value-functions-block" class="prefs-block">
  <h4>Partial Value Functions <inline-help help-key="partial-value-function"></inline-help>
  </h4>
  <div id="partial-value-functions" class="grid-x grid-padding-x small-up-1 medium-up-2 large-up-3">
    <div class="cell" ng-repeat="criterion in criteria">
      <h5>{{::criterion.title}}</h5>
      <div style="width: 250px; height: 180px">
        <line-chart ng-if="isPVFDefined(criterion.dataSources[0])" value="pvfCoordinates[criterion.id]"
          show-legend="false"></line-chart>
        <div ng-if="!isPVFDefined(criterion.dataSources[0])" style="padding-top: 40px; text-align: center; margin: 0">
          <i style="font-size: 100px" class="fa fa-question"></i>
        </div>
      </div>
      <button id="{{ criterion.id }}-pvf-button" class="button" ng-if="editMode.isUserOwner" ng-class="{alert: !isSafe['partial-value-function'].safe}"
        tooltip="{{isSafe['partial-value-function'].tooltip}}" tooltip-animation="false"
        ng-disabled="!isAccessible(tasks['partial-value-function']).accessible"
        ui-sref="partial-value-function({criterion: criterion.id})">Define partial value function</button>
    </div>
  </div>
</div>
<div class="grid-x prefs-block" id="trade-off-block">
  <div class="cell">
    <h4>
      Weights <inline-help help-key="weights"></inline-help>
    </h4>
  </div>
  <div class="cell" ng-if="criteriaHavePvf">
    <table>
      <thead>
        <th>Criterion
          <inline-help help-key="criterion"></inline-help>
        </th>
        <th>Description</th>
        <th>Unit
          <inline-help help-key="criterion-unit"></inline-help>
        </th>
        <th>Worst</th>
        <th>Best</th>
        <th ng-if="!isOrdinal">
          Importance <inline-help help-key="importance"></inline-help>
        </th>
        <th ng-if="isOrdinal">
          Ranking <inline-help help-key="ranking"></inline-help>
        </th>
      </thead>
      <tbody>
        <tr ng-repeat="criterion in criteria">
          <td>{{criterion.title}}</td>
          <td>{{criterion.description}}</td>
          <td>{{criterion.dataSources[0].unitOfMeasurement.label}}</td>
          <td>{{criterion.dataSources[0].pvf.range && pvf.worst(criterion.dataSources[0]) | number}}</td>
          <td>{{criterion.dataSources[0].pvf.range && pvf.best(criterion.dataSources[0]) | number}}</td>
          <td id="{{ criterion.id }}-ranking">{{importance[criterion.id]}}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="cell" ng-if="!criteriaHavePvf">
    <em>Not all partial value functions are defined</em>
  </div>
  <div class="cell large-4 button-group" ng-if="editMode.isUserOwner">
    <button id="reset-button" class="button alert" ng-click="resetWeights()" tooltip="Reset all weight preferences"
      ng-disabled="!problem.preferences.length" id="resetWeightsButton">
      Reset weights
    </button>
    <button id="ranking-button" class="button" ui-sref="ordinal-swing" ng-disabled="!isAccessible(tasks['ordinal-swing']).accessible"
      ng-class="{alert: !isSafe['ordinal-swing'].safe}" tooltip="{{isSafe['ordinal-swing'].tooltip}}">
      Ranking
    </button>
    <button id="matching-button" class="button" ui-sref="matching" ng-disabled="!isAccessible(tasks['matching']).accessible"
      ng-class="{alert: !isSafe['matching'].safe}" tooltip="{{isSafe['matching'].tooltip}}">
      Matching
    </button>
    <button id="precise-swing-button" class="button" ui-sref="swing-weighting" ng-disabled="!isAccessible(tasks['swing-weighting']).accessible"
      ng-class="{alert: !isSafe['swing-weighting'].safe}" tooltip="{{isSafe['swing-weighting'].tooltip}}">
      Precise Swing Weighting
    </button>
    <button id="imprecise-swing-button" class="button" ui-sref="imprecise-swing-weighting"
      ng-disabled="!isAccessible(tasks['imprecise-swing-weighting']).accessible"
      ng-class="{alert: !isSafe['imprecise-swing-weighting'].safe}"
      tooltip="{{isSafe['imprecise-swing-weighting'].tooltip}}">
      Imprecise Swing Weighting
    </button>
  </div>
</div>
<div class="cell" ng-if="criteriaHavePvf">
  <willingness-to-trade-off state="aggregateState"></willingness-to-trade-off>
</div>
